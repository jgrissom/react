(this["webpackJsonpmedals-b-react"]=this["webpackJsonpmedals-b-react"]||[]).push([[0],{32:function(e,n,t){},58:function(e,n,t){},59:function(e,n,t){"use strict";t.r(n);var c=t(3),r=t.n(c),a=t(25),o=t.n(a),s=(t(32),t(11)),i=t(5),u=t.n(i),l=t(9),d=t(15),f=t(10),m=t.n(f),b=t(27),p=t(2),j=function(e){var n=e.medal,t=e.country,c=e.onIncrement,r=e.onDecrement;return Object(p.jsxs)("div",{className:"medals",children:[n.name," Medals: ",t[n.name],Object(p.jsx)("button",{onClick:function(){return c(t.id,n.name)},children:"+"}),Object(p.jsx)("button",{disabled:0===t[n.name],onClick:function(){return r(t.id,n.name)},children:"-"})]})},h=function(e){var n=e.country,t=e.medals,c=e.onIncrement,r=e.onDecrement,a=e.onDelete;return Object(p.jsxs)("div",{className:"country",children:[Object(p.jsxs)("div",{className:"name",children:[n.name,Object(p.jsx)("span",{className:"badge",children:function(e,n){var t=0;return n.forEach((function(n){t+=e[n.name]})),t}(n,t)})]}),t.map((function(e){return Object(p.jsx)(j,{country:n,medal:e,onIncrement:c,onDecrement:r},e.id)})),Object(p.jsx)("button",{onClick:function(){return a(n.id)},children:"delete"}),Object(p.jsx)("hr",{})]})},v=function(e){var n=e.onAdd;return Object(p.jsx)("div",{className:"newCountryButton",children:Object(p.jsx)("button",{onClick:function(){var e=prompt("Enter country name");e&&e.trim().length>0&&n(e)},children:"New Country"})})},O=(t(58),function(){var e="https://medalsapi.azurewebsites.net/api/country",n=Object(c.useState)([]),t=Object(d.a)(n,2),a=t[0],o=t[1],i=Object(c.useState)(null),f=Object(d.a)(i,2),j=f[0],O=f[1],x=Object(c.useRef)([{id:1,name:"gold"},{id:2,name:"silver"},{id:3,name:"bronze"}]),g=Object(c.useRef)(null);g.current=a,Object(c.useEffect)((function(){function n(){return(n=Object(l.a)(u.a.mark((function n(){var t,c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.get(e);case 2:t=n.sent,c=t.data,o(c);case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}();var t=(new b.a).withUrl("https://medalsapi.azurewebsites.net/medalsHub").withAutomaticReconnect().build();O(t)}),[]),Object(c.useEffect)((function(){j&&j.start().then((function(){console.log("Connected!"),j.on("ReceiveAddMessage",(function(e){console.log("Add: ".concat(e.name));var n=Object(s.a)(g.current);n=n.concat(e),o(n)})),j.on("ReceiveDeleteMessage",(function(e){console.log("Delete id: ".concat(e));var n=Object(s.a)(g.current);n=n.filter((function(n){return n.id!==e})),o(n)})),j.on("ReceivePatchMessage",(function(e){console.log("Patch: ".concat(e.name));var n=Object(s.a)(g.current),t=n.findIndex((function(n){return n.id===e.id}));n[t]=e,o(n)}))})).catch((function(e){return console.log("Connection failed: ",e)}))}),[j]);var y=function(){var n=Object(l.a)(u.a.mark((function n(t){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.post(e,{name:t});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),w=function(){var n=Object(l.a)(u.a.mark((function n(t){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a,o(a.filter((function(e){return e.id!==t}))),n.prev=2,n.next=5,m.a.delete("".concat(e,"/").concat(t));case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),n.t0.response&&404===n.t0.response.status?console.log("The record does not exist - it may have already been deleted"):(alert("An error occurred while deleting"),o(c));case 10:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e){return n.apply(this,arguments)}}(),k=function(e,n){return N(e,n,1)},C=function(e,n){return N(e,n,-1)},N=function(){var n=Object(l.a)(u.a.mark((function n(t,c,r){var i,l,d,f;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=a,l=a.findIndex((function(e){return e.id===t})),(d=Object(s.a)(a))[l][c]+=1*r,o(d),f=[{op:"replace",path:c,value:d[l][c]}],console.log("json patch for id: ".concat(t,": ").concat(JSON.stringify(f))),n.prev=7,n.next=10,m.a.patch("".concat(e,"/").concat(t),f);case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(7),n.t0.response&&404===n.t0.response.status?console.log("The record does not exist - it may have already been deleted"):(alert("An error occurred while updating"),o(i));case 15:case"end":return n.stop()}}),n,null,[[7,12]])})));return function(e,t,c){return n.apply(this,arguments)}}();return Object(p.jsxs)(r.a.Fragment,{children:[Object(p.jsxs)("div",{className:"appHeading",children:["Olympic Medals",Object(p.jsx)("span",{className:"badge",children:function(){var e=0;return x.current.forEach((function(n){e+=a.reduce((function(e,t){return e+t[n.name]}),0)})),e}()})]}),Object(p.jsx)("div",{className:"countries",children:a.map((function(e){return Object(p.jsx)(h,{country:e,medals:x.current,onDelete:w,onIncrement:k,onDecrement:C},e.id)}))}),Object(p.jsx)(v,{onAdd:y})]})}),x=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,60)).then((function(n){var t=n.getCLS,c=n.getFID,r=n.getFCP,a=n.getLCP,o=n.getTTFB;t(e),c(e),r(e),a(e),o(e)}))};o.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(O,{})}),document.getElementById("root")),x()}},[[59,1,2]]]);
//# sourceMappingURL=main.d7190c58.chunk.js.map